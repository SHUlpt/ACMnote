## 数学-线性基

### 定义

异或运算可以看作是模2域下的加法运算，如果把一个数转化为二进制，对应成一个由01构成的向量，所有的向量就构成一个线性空间。**线性基就是求这个向量组的极大线性无关组**

**线性基的思想：**  
在线性代数里，一个向量组可以用一个极大线性无关组完全表示，用更少、更小的向量来表示整个线性组。  
在线性基中，假设有$n$个数，这些数$x$相互异或得到的一些数$y$称为$x$的值域。通过极大线性无关组就可以使用更少、更小的数，依然能够求出值域$y$

通俗的说，线性基就是由一个集合构造出来的另一个集合

### 性质

- 线性基的元素能相互异或得到原集合的元素的所有相互异或得到的值
- 线性基使满足性质1的最小的集合
- 线性基没有异或和为0的子集
- 线性基中每个元素的异或方案唯一，也就是说，线性基中不同的异或组合异或出的数都是不一样的
- 线性基中每个元素的二进制最高位互不相同

### 求线性基

求极大线性无关组的方法是采用高斯消元法，而对于异或运算，有如下特殊的性质：

- 取向量组中的两个向量$a,b$，把$a,b$中的某一个替换为$a \oplus b$，替换前后向量组中的向量的线性组合得到的线性空间是相同的

  > 证明：  
  > 假设把$b$换成了$c=a\oplus b$。对于一个值$x$，如果不需要用到$b$，则无影响；如果需要$b$，可以根据$b=c\oplus a$来得到

因此，如果将向量组里的向量相互异或，极大线性无关向量组的大小是不变的，可以利用这个性质实现高斯消元。

从最高位开始扫描每个向量，对于第$i$个向量的第$j$位，如果前面已经存在第$j$为1的向量，就把第$i$个向量异或那个向量（实现高斯消元）；如果不存在，则加入到极大线性无关组中。

这样最后得到的向量组，不考虑0向量，最高位的1的位置都是各不相同的，显然这些向量线性无关

```c++
int n;      	//元素个数
int Bit;    	//二进制最大位数
int A[n], P[n]; //A:原集合, P:新集合
void Insert() {
    for (int i = 1; i <= n; i++) {
        for (int j = Bit; j >= 0; j--) {
            if ((A[i] >> j) & 1) {
                if (!P[j]) {	
                    P[j] = A[i];
                    break;
                }
                else A[i] ^= P[j];
            }
        }
    }
    int r = 0; //线性无关组大小
    for (int i = 0; i <= Bit; i++) {
        if (P[i]) r++;
    }
}
```



### 常用操作

#### 最大/小值

给出$n$个数，从中选出一个子集，使得异或和最大

方法：从高位向低位贪心，由于后面的数无法改变高位，只要高位变为最大/小的即可

```c++
for (int i = Bit; i >= 0; i--) {
    ans = max(ans, ans ^ p[i]);
    ans = min(ans, ans ^ p[i]);
}
```

#### 查询某个数能否被异或出来

类似于插入的做法，将这个数插入线性基。如果最终插入的数$p$被异或成了0，就代表线性基中的向量可以表示出这个数，反之也不行

```c++
bool check(int x) {
	for (int i = Bit; i >= 0; i--) {
		if ((x >> i) & 1) {
			if (!P[i]) {
				return 0;
			}
			else x ^= P[i];
		}
	}
	return 1;
}
```

